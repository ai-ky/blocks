<head>
<script language="javascript">
function exec(command)
{
	window.oldOnError = window.onerror;
	window._command = command;
	window.onerror = function (err)
	{
		if (err.indexOf('utomation') != -1)
		{
			alert('命令'+window._command+' 已經被使用者禁止！');
			return true;
		}
		else	return false;
	};
	//-----------//
	var wsh = new ActiveXObject('WScript.Shell');
	if (wsh) wsh.Run(command);
	wsh = null;
	window.onerror = window.oldOnError;
}
</script>
</head>
<body>
<input onclick="exec('notepad.exe')" value="執行noteppad.exe" type="button">
<input onclick="exec('cmd.exe')" value="執行cmd.exe" type="button">
</body>
